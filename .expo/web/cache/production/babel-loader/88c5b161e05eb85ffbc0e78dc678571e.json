{"ast":null,"code":"import _toConsumableArray from\"@babel/runtime/helpers/toConsumableArray\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import React,{useState,useEffect}from'react';import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import SafeAreaView from\"react-native-web/dist/exports/SafeAreaView\";import TextInput from\"react-native-web/dist/exports/TextInput\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import ActivityIndicator from\"react-native-web/dist/exports/ActivityIndicator\";import ScrollView from\"react-native-web/dist/exports/ScrollView\";import{FlatList}from'react-native-gesture-handler';import{TouchableOpacity}from'react-native-gesture-handler';import axiox from'axios';import{MAIN_URL,USER}from\"../constants/variables\";var UserListScreen=function UserListScreen(_ref){var navigation=_ref.navigation,route=_ref.route;var sheetID=route.params.sheetID;var year=route.params.year;var part=route.params.part;var userid=USER.userid;var position=USER.position;var department=USER.department;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),users=_useState2[0],setUsers=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setLoading=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),userNotComplete=_useState6[0],setUserNotComplete=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),arrayholder=_useState8[0],setArrayholder=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),text=_useState10[0],setText=_useState10[1];var getAllQuestion=function getAllQuestion(){setLoading(true);axiox.get(MAIN_URL+'/question/staff/'+year+'/'+part).then(function(res){getUsers(res.data.length);}).catch(function(err){console.log(err);setLoading(false);});};var getUsers=function getUsers(choiceCount){return _regeneratorRuntime.async(function getUsers$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _regeneratorRuntime.awrap(axiox.get(MAIN_URL+'/users/'+year+'/'+part+'/'+choiceCount).then(function(res){setUsers(res.data);setLoading(false);setArrayholder(res.data);getUsersNoComplete(choiceCount);}).catch(function(err){console.log(err);}));case 2:case\"end\":return _context.stop();}}},null,null,null,Promise);};var getUsersNoComplete=function getUsersNoComplete(choiceCount){return _regeneratorRuntime.async(function getUsersNoComplete$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:console.log(MAIN_URL+'/users/'+year+'/'+part+'/notcomplete/'+choiceCount);_context2.next=3;return _regeneratorRuntime.awrap(axiox.get(MAIN_URL+'/users/'+year+'/'+part+'/notcomplete/'+choiceCount).then(function(res){console.log(res.data);setUserNotComplete(res.data);setLoading(false);}).catch(function(err){console.log(err);}));case 3:case\"end\":return _context2.stop();}}},null,null,null,Promise);};var getDepartment=function getDepartment(){console.log(department);axiox.get(MAIN_URL+'/users/department/'+department).then(function(res){for(var i=0;i<res.data.length;i++){setUsers(function(pre){return[].concat(_toConsumableArray(pre),[res.data[i]]);});setArrayholder(function(holder){return[].concat(_toConsumableArray(holder),[res.data[i]]);});}setLoading(false);if(department==='AR'){departmentAR();console.log(\"TEST\");}}).catch(function(err){console.log(err);setLoading(false);});};var departmentIT=function departmentIT(){axiox.get(MAIN_URL+'/users/department/IT').then(function(res){for(var i=0;i<res.data.length;i++){setUsers(function(pre){return[].concat(_toConsumableArray(pre),[res.data[i]]);});setArrayholder(function(holder){return[].concat(_toConsumableArray(holder),[res.data[i]]);});}departmentOP();}).catch(function(err){console.log(err);setLoading(false);});};var departmentOP=function departmentOP(){axiox.get(MAIN_URL+'/users/department/OP').then(function(res){for(var i=0;i<res.data.length;i++){setUsers(function(pre){return[].concat(_toConsumableArray(pre),[res.data[i]]);});setArrayholder(function(holder){return[].concat(_toConsumableArray(holder),[res.data[i]]);});}setLoading(false);console.log(users);}).catch(function(err){console.log(err);setLoading(false);});};var departmentAR=function departmentAR(){axiox.get(MAIN_URL+'/users/department/AD').then(function(res){for(var i=0;i<res.data.length;i++){setUsers(function(pre){return[].concat(_toConsumableArray(pre),[res.data[i]]);});setArrayholder(function(holder){return[].concat(_toConsumableArray(holder),[res.data[i]]);});}setLoading(false);}).catch(function(err){console.log(err);setLoading(false);});};useEffect(function(){setLoading(true);if(sheetID===5){if(position==='admin'||department==='MD'){departmentIT();}else{getDepartment();}}else{if(position==='admin'||department==='MD'){getAllQuestion();}else{getDepartment();}}},[]);var searchData=function searchData(text){var newData=arrayholder.filter(function(item){var itemData=item.nickname;var textData=text;return itemData.indexOf(textData)>-1;});setUsers(newData);setText(text);};var renderUsers=function renderUsers(_ref2){var navigation=_ref2.navigation;var renderItem=function renderItem(_ref3){var item=_ref3.item;return React.createElement(TouchableOpacity,{onPress:function onPress(){sheetID===5?navigation.navigate('EmployeeStatus',{sheetID:sheetID,user:item}):navigation.navigate('Questionnaire',{sheetID:sheetID,userId:item.userid,year:year,part:part});}},React.createElement(View,{style:{backgroundColor:'white',borderWidth:0.5,padding:8,borderRadius:10,margin:4}},React.createElement(Text,{style:{fontSize:18,fontWeight:'bold',color:'blue'}},\"\\u0E0A\\u0E37\\u0E48\\u0E2D : \",item.name+\" \"+item.lastname),React.createElement(Text,{style:{fontSize:18,fontWeight:'bold',color:'red'}},\"\\u0E0A\\u0E37\\u0E48\\u0E2D\\u0E40\\u0E25\\u0E48\\u0E19 : \",item.nickname),React.createElement(Text,null,\"\\u0E40\\u0E1A\\u0E2D\\u0E23\\u0E4C\\u0E42\\u0E17\\u0E23 :\",item.phone),React.createElement(Text,null,\"\\u0E41\\u0E1C\\u0E19\\u0E01 : \",item.department)));};return sheetID===2&&department===\"MD\"?React.createElement(FlatList,{data:users,keyExtractor:function keyExtractor(item,index){return\"\"+index;},shouldComponentUpdate:false,renderItem:renderItem,ListHeaderComponent:React.createElement(View,{style:{borderRadius:8,backgroundColor:'green',padding:20}},React.createElement(Text,{style:{color:'white',fontSize:20}},\"\\u0E04\\u0E19\\u0E15\\u0E2D\\u0E1A\\u0E04\\u0E33\\u0E16\\u0E32\\u0E21\\u0E04\\u0E23\\u0E1A\")),ListFooterComponent:React.createElement(FlatList,{data:userNotComplete,keyExtractor:function keyExtractor(item,index){return\"\"+index;},shouldComponentUpdate:false,renderItem:renderItem,ListHeaderComponent:React.createElement(View,{style:{borderRadius:8,backgroundColor:'red',padding:20}},React.createElement(Text,{style:{color:'white',fontSize:20}},\"\\u0E04\\u0E19\\u0E15\\u0E2D\\u0E1A\\u0E04\\u0E33\\u0E16\\u0E32\\u0E21\\u0E44\\u0E21\\u0E48\\u0E04\\u0E23\\u0E1A\"))})}):React.createElement(FlatList,{data:users,keyExtractor:function keyExtractor(item,index){return\"\"+index;},shouldComponentUpdate:false,renderItem:renderItem});};return React.createElement(SafeAreaView,{style:{flex:1}},React.createElement(TextInput,{style:styles.textInput,onChangeText:function onChangeText(text){return searchData(text);},value:text,underlineColorAndroid:\"transparent\",placeholder:\"\\u0E04\\u0E49\\u0E19\\u0E2B\\u0E32\\u0E08\\u0E32\\u0E01\\u0E0A\\u0E37\\u0E48\\u0E2D\\u0E40\\u0E25\\u0E48\\u0E19\"}),position==='ผู้จัดการ'&&department===\"MD\"?React.createElement(View,{style:{borderBottomWidth:0.5,borderBottomColor:'gray'}},React.createElement(Text,{style:{color:'green',marginHorizontal:8,marginBottom:8}},\"\\u0E08\\u0E33\\u0E19\\u0E27\\u0E19\\u0E04\\u0E19\\u0E15\\u0E2D\\u0E1A\\u0E04\\u0E33\\u0E16\\u0E32\\u0E21\\u0E04\\u0E23\\u0E1A \",users.length,\" \\u0E04\\u0E19\"),React.createElement(Text,{style:{color:'red',marginHorizontal:8,marginBottom:8}},\"\\u0E08\\u0E33\\u0E19\\u0E27\\u0E19\\u0E04\\u0E19\\u0E15\\u0E2D\\u0E1A\\u0E04\\u0E33\\u0E16\\u0E32\\u0E21\\u0E44\\u0E21\\u0E48\\u0E04\\u0E23\\u0E1A \",userNotComplete.length,\" \\u0E04\\u0E19\")):null,renderUsers({navigation:navigation}),isLoading?React.createElement(ActivityIndicator,{style:{position:'absolute',left:0,right:0,top:0,bottom:0,alignItems:'center',justifyContent:'center'},size:\"large\",color:\"#0275d8\"}):null);};var styles=StyleSheet.create({textInput:{margin:8,paddingHorizontal:16,height:42,borderWidth:1,borderColor:'#009688',borderRadius:8,backgroundColor:\"#FFFF\"}});export default UserListScreen;","map":{"version":3,"sources":["/Users/drift/Documents/ReactNative/cal-assessment/src/screens/UserListScreen.js"],"names":["React","useState","useEffect","FlatList","TouchableOpacity","axiox","MAIN_URL","USER","UserListScreen","navigation","route","sheetID","params","year","part","userid","position","department","users","setUsers","isLoading","setLoading","userNotComplete","setUserNotComplete","arrayholder","setArrayholder","text","setText","getAllQuestion","get","then","res","getUsers","data","length","catch","err","console","log","choiceCount","getUsersNoComplete","getDepartment","i","pre","holder","departmentAR","departmentIT","departmentOP","searchData","newData","filter","item","itemData","nickname","textData","indexOf","renderUsers","renderItem","navigate","user","userId","backgroundColor","borderWidth","padding","borderRadius","margin","fontSize","fontWeight","color","name","lastname","phone","index","flex","styles","textInput","borderBottomWidth","borderBottomColor","marginHorizontal","marginBottom","left","right","top","bottom","alignItems","justifyContent","StyleSheet","create","paddingHorizontal","height","borderColor"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { View, Text, SafeAreaView, TextInput, StyleSheet, ActivityIndicator, ScrollView } from 'react-native';\nimport { FlatList } from 'react-native-gesture-handler';\nimport { TouchableOpacity } from 'react-native-gesture-handler';\n\nimport axiox from 'axios';\nimport { MAIN_URL, USER } from '../constants/variables';\n\nconst UserListScreen = ({ navigation, route }) => {\n\n    let sheetID = route.params.sheetID;\n    let year = route.params.year;\n    let part = route.params.part;\n    let userid = USER.userid;\n    let position = USER.position;\n    let department = USER.department;\n\n    const [users, setUsers] = useState([]);\n    const [isLoading, setLoading] = useState(false);\n    const [userNotComplete, setUserNotComplete] = useState([]);\n\n    const [arrayholder, setArrayholder] = useState([])\n    const [text, setText] = useState(\"\");\n    // const[data, setData] = useState([])\n\n\n    const getAllQuestion = () => {\n        setLoading(true);\n        axiox.get(MAIN_URL + '/question/staff/' + year + '/' + part)\n            .then(res => {\n                getUsers(res.data.length);\n\n            })\n            .catch(err => {\n                console.log(err)\n                setLoading(false);\n            });\n    };\n\n    const getUsers = async (choiceCount) => {\n        // console.log(choiceCount);\n        await axiox.get(MAIN_URL + '/users/' + year + '/' + part + '/' + choiceCount)\n            .then(res => {\n                setUsers(res.data);\n                setLoading(false);\n                setArrayholder(res.data)\n                getUsersNoComplete(choiceCount);\n                // console.log(users);\n            })\n            .catch(err => {\n                console.log(err)\n            })\n    };\n\n    const getUsersNoComplete = async (choiceCount) => {\n        console.log(MAIN_URL + '/users/' + year + '/' + part + '/notcomplete/' + choiceCount);\n        await axiox.get(MAIN_URL + '/users/' + year + '/' + part + '/notcomplete/' + choiceCount)\n            .then(res => {\n                console.log(res.data);\n                setUserNotComplete(res.data);\n                setLoading(false);\n\n                // setArrayholder(res.data)\n                // console.log(users);\n            })\n            .catch(err => {\n                console.log(err)\n            })\n    };\n\n    const getDepartment = () => {\n        console.log(department);\n        // console.log(MAIN_URL + '/users/department/' + department);\n        axiox.get(MAIN_URL + '/users/department/' + department)\n            .then(res => {\n                for(var i = 0; i < res.data.length; i++){\n                    setUsers(pre => [...pre, res.data[i]]);\n                    setArrayholder(holder => [...holder, res.data[i]])\n                }\n                // setUsers(res.data);\n                setLoading(false);\n                // setArrayholder(res.data);\n\n                if(department === 'AR'){\n                    departmentAR();\n                    console.log(\"TEST\")\n                }\n                // console.log(users);\n            })\n            .catch(err => {\n                console.log(err)\n                setLoading(false);\n            })\n    };\n\n    const departmentIT = () => {\n        axiox.get(MAIN_URL + '/users/department/IT')\n            .then(res => {\n                for(var i = 0; i < res.data.length; i++){\n                    setUsers(pre => [...pre, res.data[i]]);\n                    setArrayholder(holder => [...holder, res.data[i]])\n                }\n                // setUsers(pre => [pre, res.data]);\n                // setLoading(false);\n                \n                \n                departmentOP();\n            })\n            .catch(err => {\n                console.log(err)\n                setLoading(false);\n            })\n    }\n\n    const departmentOP = () => {\n        axiox.get(MAIN_URL + '/users/department/OP')\n            .then(res => {\n                for(var i = 0; i < res.data.length; i++){\n                    setUsers(pre => [...pre, res.data[i]]);\n                    setArrayholder(holder => [...holder, res.data[i]])\n                }\n              \n                setLoading(false);\n                \n                console.log(users);\n            })\n            .catch(err => {\n                console.log(err)\n                setLoading(false);\n            })\n    }\n\n    const departmentAR = () => {\n        axiox.get(MAIN_URL + '/users/department/AD')\n            .then(res => {\n                for(var i = 0; i < res.data.length; i++){\n                    setUsers(pre => [...pre, res.data[i]]);\n                    setArrayholder(holder => [...holder, res.data[i]])\n                }\n              \n                setLoading(false);\n                \n                // console.log(users);\n            })\n            .catch(err => {\n                console.log(err)\n                setLoading(false);\n            })\n    }\n\n    useEffect(() => {\n        setLoading(true);\n        if (sheetID === 5) {\n            if (position === 'admin' || department === 'MD') {\n                departmentIT();\n            } else {\n                getDepartment();\n            }\n        }\n        else {\n            if (position === 'admin' || department === 'MD') {\n                getAllQuestion();\n            } else {\n                getDepartment();\n            }\n        }\n\n\n\n    }, []);\n\n    const searchData = (text) => {\n\n        const newData = arrayholder.filter(item => {\n            // console.log(item.nickname)\n            const itemData = item.nickname;\n            const textData = text;\n            return itemData.indexOf(textData) > -1\n        });\n        setUsers(newData);\n        setText(text);\n    }\n\n    // const itemSeparator = () => {\n    //     return (\n    //         <View\n    //             style={{\n    //                 height: .5,\n    //                 width: \"100%\",\n    //                 backgroundColor: \"#000\",\n    //             }}\n    //         />\n    //     );\n    // }\n\n\n    const renderUsers = ({ navigation }) => {\n\n        // console.log(users);\n\n        const renderItem = ({ item }) => {\n            return (\n                <TouchableOpacity\n                    onPress={() => {\n                        sheetID === 5 ?\n                            navigation.navigate('EmployeeStatus', {\n                                sheetID: sheetID,\n                                user: item\n                            }) :\n                            // console.log(item.name);\n                            navigation.navigate('Questionnaire', {\n                                sheetID: sheetID,\n                                userId: item.userid,\n                                year: year,\n                                part: part\n                            });\n                    }}>\n                    <View style={{ backgroundColor: 'white', borderWidth: 0.5, padding: 8, borderRadius: 10, margin: 4 }}>\n                        <Text style={{ fontSize: 18, fontWeight: 'bold', color: 'blue' }}>\n                            ชื่อ : {item.name + \" \" + item.lastname}\n                        </Text>\n                        <Text style={{ fontSize: 18, fontWeight: 'bold', color: 'red' }}>\n                            ชื่อเล่น : {item.nickname}\n                        </Text>\n                        <Text>\n                            เบอร์โทร :{item.phone}\n                        </Text>\n                        <Text>\n                            แผนก : {item.department}\n                        </Text>\n                    </View>\n                </TouchableOpacity>\n            );\n        }\n\n        return (\n            sheetID === 2 && department === \"MD\" ?\n\n                <FlatList\n                    data={users}\n                    keyExtractor={(item, index) => `${index}`}\n                    // ItemSeparatorComponent={itemSeparator}\n                    shouldComponentUpdate={false}\n                    renderItem={renderItem}\n                    ListHeaderComponent={\n                        <View style={{ borderRadius: 8, backgroundColor: 'green', padding: 20 }}>\n                            <Text style={{ color: 'white', fontSize: 20 }}>คนตอบคำถามครบ</Text>\n                        </View>\n                    }\n                    ListFooterComponent={\n                        <FlatList\n                            data={userNotComplete}\n                            keyExtractor={(item, index) => `${index}`}\n                            // ItemSeparatorComponent={itemSeparator}\n                            shouldComponentUpdate={false}\n                            renderItem={renderItem}\n                            ListHeaderComponent={\n                                <View style={{ borderRadius: 8, backgroundColor: 'red', padding: 20 }}>\n                                    <Text style={{ color: 'white', fontSize: 20 }}>คนตอบคำถามไม่ครบ</Text>\n                                </View>\n                            }\n                        />\n                    }\n\n                // horizontal\n                // showsHorizontalScrollIndicator={false}\n                />\n\n                :\n                <FlatList\n                    data={users}\n                    keyExtractor={(item, index) => `${index}`}\n                    // ItemSeparatorComponent={itemSeparator}\n                    shouldComponentUpdate={false}\n                    renderItem={renderItem}\n                // horizontal\n                // showsHorizontalScrollIndicator={false}\n                />\n\n        );\n    }\n\n    return (\n        <SafeAreaView style={{ flex: 1 }}>\n\n            <TextInput\n                style={styles.textInput}\n                onChangeText={(text) => searchData(text)}\n                value={text}\n                underlineColorAndroid='transparent'\n                placeholder=\"ค้นหาจากชื่อเล่น\" />\n\n            {position === 'ผู้จัดการ' && department === \"MD\" ?\n                <View style={{ borderBottomWidth: 0.5, borderBottomColor: 'gray' }}>\n                    <Text style={{ color: 'green', marginHorizontal: 8, marginBottom: 8, }}>จำนวนคนตอบคำถามครบ {users.length} คน</Text>\n                    <Text style={{ color: 'red', marginHorizontal: 8, marginBottom: 8, }}>จำนวนคนตอบคำถามไม่ครบ {userNotComplete.length} คน</Text>\n                </View>\n                :\n\n                null}\n\n\n            {renderUsers({ navigation })}\n\n            {isLoading ?\n\n                <ActivityIndicator style={{\n\n                    position: 'absolute',\n                    left: 0,\n                    right: 0,\n                    top: 0,\n                    bottom: 0,\n                    alignItems: 'center',\n                    justifyContent: 'center'\n                }} size=\"large\" color=\"#0275d8\" />\n                :\n                null\n            }\n\n        </SafeAreaView>\n\n    );\n}\n\nconst styles = StyleSheet.create({\n    textInput: {\n        margin: 8,\n        paddingHorizontal: 16,\n        height: 42,\n        borderWidth: 1,\n        borderColor: '#009688',\n        borderRadius: 8,\n        backgroundColor: \"#FFFF\"\n\n    }\n});\n\nexport default UserListScreen;"]},"metadata":{},"sourceType":"module"}