{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import React,{useState,useEffect}from'react';import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import TextInput from\"react-native-web/dist/exports/TextInput\";import FlatList from\"react-native-web/dist/exports/FlatList\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import TouchableOpacity from\"react-native-web/dist/exports/TouchableOpacity\";import ActivityIndicator from\"react-native-web/dist/exports/ActivityIndicator\";import{Button,Card}from'react-native-paper';import{CheckBox}from'react-native-elements';import axiox from'axios';import{COLORS,SIZES}from\"../constants/theme\";import moment from'moment';import'moment/locale/th';import{MAIN_URL,USER}from\"../constants/variables\";var StaffCommentScreen=function StaffCommentScreen(_ref){var navigation=_ref.navigation,route=_ref.route;var userId=USER.userid;var managerID=route.params.managerID;var year=route.params.year;var part=route.params.part;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),answer=_useState2[0],setAnswer=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),allAnswer=_useState6[0],setAllAnswer=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),questionWithAnswer=_useState8[0],setQuestionWithAnswer=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),question=_useState10[0],setQuestion=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),checked=_useState12[0],setChecked=_useState12[1];var _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),selectedColor=_useState14[0],setSelectedColor=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),list=_useState16[0],setList=_useState16[1];var _useState17=useState(0),_useState18=_slicedToArray(_useState17,2),checkIndex=_useState18[0],setCheckIndex=_useState18[1];useEffect(function(){setLoading(true);USER.position===\"ผู้จัดการ\"?getAllQuestion():getAllQuestionWithAnswer();},[]);var getAllQuestionWithAnswer=function getAllQuestionWithAnswer(){setLoading(true);axiox.get(MAIN_URL+'/answer/comment/user/'+year+'/'+part+'/'+managerID+'/'+userId).then(function(res){setQuestionWithAnswer(res.data);setLoading(false);}).catch(function(err){console.log(err);setLoading(false);});};var getAllQuestion=function getAllQuestion(){setLoading(true);axiox.get(MAIN_URL+'/question/comment/'+year+'/'+part).then(function(res){setQuestion(res.data);setLoading(false);}).catch(function(err){console.log(err);setLoading(false);});};var getAllAnswer=function getAllAnswer(){setLoading(true);axiox.get(MAIN_URL+'/answer/comment/user/'+year+'/'+part+'/department/'+USER.department).then(function(res){setAllAnswer(res.data);setLoading(false);}).catch(function(err){console.log(err);setLoading(false);});};var getAnswerWithManagerId=function getAnswerWithManagerId(_ref2){var number=_ref2.number;setLoading(true);axiox.get(MAIN_URL+'/answer/comment/manager/'+year+'/'+part+'/'+userId+'/'+number).then(function(res){console.log(res.data);setAnswer(res.data);setLoading(false);}).catch(function(err){console.log(err);setLoading(false);});};var postAnswer=function postAnswer(_ref3){var dataSend=_ref3.dataSend,number=_ref3.number;setLoading(true);axiox.post(MAIN_URL+'/answer/comment/user/'+year+'/'+part+'/'+userId+'/'+number,dataSend).then(function(res){alert(\"บันทึกข้อมูลสำเร็จ\");setLoading(false);}).catch(function(err){console.log(err);alert(\"บันทึกข้อมูลล้มเหลว กรุณาลองใหม่\");setLoading(false);});};var renderManagerCheck=function renderManagerCheck(){var renderItem=function renderItem(_ref4){var item=_ref4.item,index=_ref4.index;return React.createElement(View,null,React.createElement(TouchableOpacity,{style:selectedColor===index?{borderRadius:10,backgroundColor:'green',padding:10,margin:10}:{borderRadius:10,borderColor:'gray',borderWidth:.3,backgroundColor:'#F8F8FF',padding:10,margin:10},onPress:function onPress(){setAnswer([]);setSelectedColor(index);setCheckIndex(index);getAnswerWithManagerId({number:item.number});}},React.createElement(Text,{style:selectedColor===index?{color:'white',fontSize:16}:{color:'black',fontSize:16}},index+1,\".  \",item.qt)),checkIndex===index?!loading?answer.length!=0?React.createElement(View,{style:{padding:16,margin:8,borderRadius:10,borderWidth:.3,borderColor:'gray'}},React.createElement(FlatList,{data:answer,extraData:answer,keyExtractor:function keyExtractor(item,index){return\"\"+index;},renderItem:renderComment,ListHeaderComponent:React.createElement(Text,{style:{marginBottom:16,alignSelf:'center',fontSize:14}},\"\\u0E04\\u0E27\\u0E32\\u0E21\\u0E04\\u0E34\\u0E14\\u0E40\\u0E2B\\u0E47\\u0E19\\u0E17\\u0E31\\u0E49\\u0E07\\u0E2B\\u0E21\\u0E14\")})):selectedColor!=''?React.createElement(View,{style:{padding:16,margin:8,borderRadius:10,borderWidth:.3,borderColor:'gray'}},React.createElement(Text,{style:{alignSelf:'center'}},\"\\u0E44\\u0E21\\u0E48\\u0E21\\u0E35\\u0E04\\u0E27\\u0E32\\u0E21\\u0E04\\u0E34\\u0E14\\u0E40\\u0E2B\\u0E47\\u0E19\")):null:React.createElement(ActivityIndicator,null):null);};var renderComment=function renderComment(_ref5){var item=_ref5.item,index=_ref5.index;return React.createElement(View,{style:{marginVertical:8}},item.reveal===0?React.createElement(Text,{style:{fontSize:15,fontWeight:'bold'}},item.name,\" \",item.lastname,\" (\",item.nickname,\") [\",item.department,\"] \",React.createElement(Text,{style:{fontSize:12,color:'gray'}},\" - \\u0E27\\u0E31\\u0E19\\u0E17\\u0E35\\u0E48 \",moment(item.date).format('ll'))):React.createElement(Text,{style:{fontSize:15,fontWeight:'bold'}},\"\\u0E44\\u0E21\\u0E48\\u0E40\\u0E1B\\u0E34\\u0E14\\u0E40\\u0E1C\\u0E22\\u0E0A\\u0E37\\u0E48\\u0E2D \",React.createElement(Text,{style:{fontSize:12,color:'gray'}},\" - \\u0E27\\u0E31\\u0E19\\u0E17\\u0E35\\u0E48 \",moment(item.date).format('ll'))),React.createElement(View,{style:{marginVertical:8,borderRadius:5,borderColor:'gray',borderWidth:.3}},React.createElement(Text,{style:{color:'green',padding:8}},item.answer)));};return React.createElement(View,{style:{marginBottom:18}},React.createElement(View,null,React.createElement(FlatList,{data:question,extraData:question,keyExtractor:function keyExtractor(item,index){return\"\"+index;},renderItem:renderItem,ListHeaderComponent:React.createElement(View,{style:{margin:16}},React.createElement(Text,{style:{alignSelf:'center',fontSize:18}},\"\\u0E40\\u0E25\\u0E37\\u0E2D\\u0E01\\u0E2B\\u0E31\\u0E27\\u0E02\\u0E49\\u0E2D\"))})));};var renderUserComment=function renderUserComment(){var renderItem=function renderItem(_ref6){var item=_ref6.item,index=_ref6.index;return React.createElement(View,{style:{padding:8,margin:15,backgroundColor:'white',borderColor:'gray',borderWidth:.3}},React.createElement(Text,{style:{fontSize:16}},item.number,\". \",item.qt),React.createElement(TextInput,{style:{backgroundColor:'white',marginTop:20,borderWidth:1,padding:10,borderRadius:5,marginVertical:8,height:150},placeholder:\"\\u0E04\\u0E33\\u0E15\\u0E2D\\u0E1A\",placeholderTextColor:\"gray\",multiline:true,numberOfLines:6,color:\"blue\",fontSize:16,onChangeText:function onChangeText(text){answer[index]=text;},defaultValue:item.answer}),React.createElement(Button,{style:{backgroundColor:'green',borderRadius:10,marginVertical:8},mode:\"Contained\",onPress:function onPress(){var dataSend={manager_id:managerID,reveal:checked,answer:answer[index],date:moment().format('yyyy-MM-DD'),department:USER.department};console.log(dataSend);console.log(\"year\",year);console.log(\"part\",part);console.log(\"number\",item.number);console.log(\"userid\",USER.userid);postAnswer({dataSend:dataSend,number:item.number});}},React.createElement(Text,{style:{alignSelf:'center',color:'white'}},\"\\u0E2A\\u0E48\\u0E07\\u0E04\\u0E33\\u0E15\\u0E2D\\u0E1A\")));};return React.createElement(FlatList,{data:questionWithAnswer,extraData:questionWithAnswer,keyExtractor:function keyExtractor(item,index){return\"\"+index;},renderItem:renderItem,ListHeaderComponent:React.createElement(View,{style:{margin:16,backgroundColor:'white',paddingBottom:16}},React.createElement(Text,{style:{fontSize:16,margin:16}},\"* \\u0E01\\u0E48\\u0E2D\\u0E19\\u0E15\\u0E2D\\u0E1A\\u0E04\\u0E33\\u0E16\\u0E32\\u0E21 \\u0E17\\u0E48\\u0E32\\u0E19\\u0E15\\u0E49\\u0E2D\\u0E07\\u0E01\\u0E32\\u0E23\\u0E40\\u0E1B\\u0E34\\u0E14\\u0E40\\u0E1C\\u0E22\\u0E0A\\u0E37\\u0E48\\u0E2D\\u0E43\\u0E2B\\u0E49\\u0E1C\\u0E39\\u0E49\\u0E08\\u0E31\\u0E14\\u0E01\\u0E32\\u0E23\\u0E17\\u0E23\\u0E32\\u0E1A\\u0E2B\\u0E23\\u0E37\\u0E2D\\u0E44\\u0E21\\u0E48\"),React.createElement(CheckBox,{title:\"\\u0E44\\u0E21\\u0E48\\u0E40\\u0E1B\\u0E34\\u0E14\\u0E40\\u0E1C\\u0E22\\u0E0A\\u0E37\\u0E48\\u0E2D\",checked:checked,onPress:function onPress(){setChecked(!checked);}}))});};return React.createElement(View,{style:{flex:1,backgroundColor:'white'}},USER.position==='ผู้จัดการ'?renderManagerCheck(navigation):renderUserComment(navigation));};var styles=StyleSheet.create({checkboxContainer:{backgroundColor:'white',borderColor:'gray',borderWidth:3,flexDirection:\"row\",marginBottom:20},checkbox:{width:20,height:20,alignSelf:\"center\"},label:{margin:8}});export default StaffCommentScreen;","map":{"version":3,"sources":["/Users/drift/Documents/ReactNative/cal-assessment/src/screens/StaffCommentScreen.js"],"names":["React","useState","useEffect","Button","Card","CheckBox","axiox","COLORS","SIZES","moment","MAIN_URL","USER","StaffCommentScreen","navigation","route","userId","userid","managerID","params","year","part","answer","setAnswer","loading","setLoading","allAnswer","setAllAnswer","questionWithAnswer","setQuestionWithAnswer","question","setQuestion","checked","setChecked","selectedColor","setSelectedColor","list","setList","checkIndex","setCheckIndex","position","getAllQuestion","getAllQuestionWithAnswer","get","then","res","data","catch","err","console","log","getAllAnswer","department","getAnswerWithManagerId","number","postAnswer","dataSend","post","alert","renderManagerCheck","renderItem","item","index","borderRadius","backgroundColor","padding","margin","borderColor","borderWidth","color","fontSize","qt","length","renderComment","marginBottom","alignSelf","marginVertical","reveal","fontWeight","name","lastname","nickname","date","format","renderUserComment","marginTop","height","text","manager_id","paddingBottom","flex","styles","StyleSheet","create","checkboxContainer","flexDirection","checkbox","width","label"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { View, Text, TextInput, FlatList, StyleSheet, TouchableOpacity, ActivityIndicator } from 'react-native';\nimport { Button, Card } from 'react-native-paper';\nimport { CheckBox } from 'react-native-elements'\n\nimport axiox from 'axios';\nimport { COLORS, SIZES } from '../constants/theme';\n\nimport moment from 'moment';\nimport 'moment/locale/th';\nimport { MAIN_URL, USER } from '../constants/variables';\n\nconst StaffCommentScreen = ({ navigation, route }) => {\n\n    // let sheetID = route.params.sheetID;\n    let userId = USER.userid;\n    // console.log(userId)\n    let managerID = route.params.managerID;\n    let year = route.params.year;\n    let part = route.params.part;\n\n    const [answer, setAnswer] = useState([]);\n    const [loading, setLoading] = useState(false);\n    const [allAnswer, setAllAnswer] = useState([]);\n    const [questionWithAnswer, setQuestionWithAnswer] = useState([]);\n    const [question, setQuestion] = useState([]);\n    // var checkArray = [];\n    const [checked, setChecked] = useState(false);\n    // const [itemSelected, setItemSeleced] = useState(0);\n    const [selectedColor, setSelectedColor] = useState('');\n    const [list, setList] = useState([]);\n    const [checkIndex, setCheckIndex] = useState(0);\n    // console.log(USER.position)\n\n    useEffect(() => {\n        setLoading(true);\n        // console.log(USER.position)\n        USER.position === \"ผู้จัดการ\" ? getAllQuestion() : getAllQuestionWithAnswer()\n\n    }, []);\n\n    const getAllQuestionWithAnswer = () => {\n        setLoading(true);\n        // console.log(MAIN_URL + '/answer/comment/user/' + year + '/' + part + '/' + managerID + '/' + userId)\n        // console.log(\"getAllQuestionWithAnswer\");\n        axiox.get(MAIN_URL + '/answer/comment/user/' + year + '/' + part + '/' + managerID + '/' + userId)\n            // console.log('https://program-api.herokuapp.com/' + year + '/' + part + '/' + answer.questionNumber + '/Answer/officer/' + userId, answer)\n            .then(res => {\n\n                setQuestionWithAnswer(res.data)\n                // alert(\"บันทึกข้อมูลสำเร็จ\");\n                setLoading(false);\n                // res.data.map(item => {\n                //     checkArray.push({\n                //         check: false\n                //     });\n                // console.log(checked)\n                // })\n            })\n            .catch(err => {\n                console.log(err)\n                // alert(\"บันทึกข้อมูลล้มเหลว กรุณาลองใหม่\");\n                setLoading(false);\n\n            });\n    };\n\n    const getAllQuestion = () => {\n        setLoading(true);\n        axiox.get(MAIN_URL + '/question/comment/' + year + '/' + part)\n            .then(res => {\n                // console.log(res.data);\n                // console.log(\"ALL DATA\", res.data);\n                setQuestion(res.data)\n\n                // alert(\"บันทึกข้อมูลสำเร็จ\");\n                setLoading(false);\n            })\n            .catch(err => {\n                console.log(err)\n                // alert(\"บันทึกข้อมูลล้มเหลว กรุณาลองใหม่\");\n                setLoading(false);\n\n            });\n    }\n\n    const getAllAnswer = () => {\n        setLoading(true);\n        // console.log(\"getAll\")\n        axiox.get(MAIN_URL + '/answer/comment/user/' + year + '/' + part + '/department/' + USER.department)\n            // console.log('https://program-api.herokuapp.com/' + year + '/' + part + '/' + answer.questionNumber + '/Answer/officer/' + userId, answer)\n            .then(res => {\n                // console.log(\"ALL DATA\", res.data);\n                setAllAnswer(res.data)\n                // alert(\"บันทึกข้อมูลสำเร็จ\");\n                setLoading(false);\n            })\n            .catch(err => {\n                console.log(err)\n                // alert(\"บันทึกข้อมูลล้มเหลว กรุณาลองใหม่\");\n                setLoading(false);\n\n            });\n    };\n\n    const getAnswerWithManagerId = ({ number }) => {\n        setLoading(true);\n\n        // console.log(\"get\", userId)\n        axiox.get(MAIN_URL + '/answer/comment/manager/' + year + '/' + part + '/' + userId + '/' + number)\n            // console.log('https://program-api.herokuapp.com/' + year + '/' + part + '/' + answer.questionNumber + '/Answer/officer/' + userId, answer)\n            .then(res => {\n                console.log(res.data);\n                setAnswer(res.data)\n                // alert(\"บันทึกข้อมูลสำเร็จ\");\n                setLoading(false);\n            })\n            .catch(err => {\n                console.log(err)\n                // alert(\"บันทึกข้อมูลล้มเหลว กรุณาลองใหม่\");\n                setLoading(false);\n\n            });\n    }\n\n    const postAnswer = ({ dataSend, number }) => {\n        setLoading(true);\n        axiox.post(MAIN_URL + '/answer/comment/user/' + year + '/' + part + '/' + userId + '/' + number, dataSend)\n            // console.log('https://program-api.herokuapp.com/' + year + '/' + part + '/' + answer.questionNumber + '/Answer/officer/' + userId, answer)\n            .then(res => {\n                // console.log(res.data);\n                alert(\"บันทึกข้อมูลสำเร็จ\");\n                setLoading(false);\n            })\n            .catch(err => {\n                console.log(err)\n                alert(\"บันทึกข้อมูลล้มเหลว กรุณาลองใหม่\");\n                setLoading(false);\n\n            });\n    }\n\n    const renderManagerCheck = () => {\n        const renderItem = ({ item, index }) => {\n            // console.log(item)\n            return (\n                <View>\n                    <TouchableOpacity\n                        style={selectedColor === index ? { borderRadius: 10, backgroundColor: 'green', padding: 10, margin: 10, } : { borderRadius: 10, borderColor: 'gray', borderWidth: .3, backgroundColor: '#F8F8FF', padding: 10, margin: 10, }}\n                        onPress={() => {\n                            setAnswer([]);\n                            setSelectedColor(index);\n                            setCheckIndex(index);\n                            // console.log(item.number)\n                            getAnswerWithManagerId({ number: item.number });\n                        }}\n                    >\n                        <Text style={selectedColor === index ? { color: 'white', fontSize: 16 } : { color: 'black', fontSize: 16 }}>{index + 1}.  {item.qt}\n\n                            {/* {\n                            item.reveal != 1 ?\n                                <Text style={{ fontSize: 14, color: 'blue' }}> {item.qt} {item.lastname} ({item.nickname}) ( แผนก/สาขา {item.department} )</Text>\n                                :\n                                <Text style={{ fontSize: 14, color: 'blue' }}> ไม่เปิดเผยชื่อ</Text>\n                        } */}\n                        </Text>\n                    </TouchableOpacity>\n                    {checkIndex === index ?\n                        !loading ?\n                            answer.length != 0 ?\n                                <View style={{ padding: 16, margin: 8, borderRadius: 10, borderWidth: .3, borderColor: 'gray' }}>\n                                    <FlatList\n                                        data={answer}\n                                        extraData={answer}\n                                        keyExtractor={(item, index) => `${index}`}\n                                        renderItem={renderComment}\n                                        ListHeaderComponent={\n                                            <Text style={{ marginBottom: 16, alignSelf: 'center', fontSize: 14 }}>ความคิดเห็นทั้งหมด</Text>\n                                        }\n                                    />\n                                </View>\n                                :\n                                selectedColor != '' ?\n                                    <View style={{ padding: 16, margin: 8, borderRadius: 10, borderWidth: .3, borderColor: 'gray' }}>\n                                        <Text style={{ alignSelf: 'center' }}>ไม่มีความคิดเห็น</Text>\n                                    </View>\n                                    :\n                                    null\n                            :\n                            <ActivityIndicator />\n\n                        :\n                        null\n                    }\n                </View>\n            )\n        }\n\n        const renderComment = ({ item, index }) => {\n            return (\n                <View style={{ marginVertical: 8 }}>\n                    {item.reveal === 0 ?\n                        <Text style={{ fontSize: 15, fontWeight: 'bold' }}>{item.name} {item.lastname} ({item.nickname}) [{item.department}] <Text style={{ fontSize: 12, color: 'gray' }}> - วันที่ {moment(item.date).format('ll')}</Text></Text>\n                        :\n                        <Text style={{ fontSize: 15, fontWeight: 'bold' }}>ไม่เปิดเผยชื่อ <Text style={{ fontSize: 12, color: 'gray' }}> - วันที่ {moment(item.date).format('ll')}</Text></Text>\n                    }\n                    <View style={{ marginVertical: 8, borderRadius: 5, borderColor: 'gray', borderWidth: .3 }}>\n                        <Text style={{ color: 'green', padding: 8 }}>{item.answer}</Text>\n                    </View>\n                </View>\n            );\n        };\n\n        return (\n            <View style={{ marginBottom: 18 }}>\n                <View>\n                    <FlatList\n                        data={question}\n                        extraData={question}\n                        keyExtractor={(item, index) => `${index}`}\n                        renderItem={renderItem}\n                        ListHeaderComponent={\n                            <View style={{ margin: 16 }}>\n                                <Text style={{ alignSelf: 'center', fontSize: 18 }}>เลือกหัวข้อ</Text>\n                            </View>\n\n                        }\n                    />\n\n                </View>\n                {/* <View style={{ padding: 16, margin: 8, borderRadius: 10, borderWidth: .3, borderColor: 'gray' }}>\n                    {answer.length != 0 ?\n                        <FlatList\n                            data={answer}\n                            extraData={answer}\n                            keyExtractor={(item, index) => `${index}`}\n                            renderItem={renderComment}\n                            ListHeaderComponent={\n                                <Text style={{ marginBottom: 16, alignSelf: 'center', fontSize: 14 }}>ความคิดเห็นทั้งหมด</Text>\n                            }\n                        />\n                        :\n                        <Text style={{ alignSelf: 'center' }}>ไม่มีความคิดเห็น</Text>\n                    }\n                </View> */}\n            </View>\n        )\n    }\n\n    const renderUserComment = () => {\n        const renderItem = ({ item, index }) => {\n            return (\n                <View style={{ padding: 8, margin: 15, backgroundColor: 'white', borderColor: 'gray', borderWidth: .3 }}>\n                    <Text style={{ fontSize: 16 }}>{item.number}. {item.qt}</Text>\n                    {/* <Text style={{ color: 'red' }}>*ผู้จัดการของแผนกคุณเท่านั้นที่จะเห็นคำตอบ แต่จะไม่รู้ว่าใครเป็นคนตอบ</Text> */}\n\n                    <TextInput\n                        style={{ backgroundColor: 'white', marginTop: 20, borderWidth: 1, padding: 10, borderRadius: 5, marginVertical: 8, height: 150 }}\n                        // textContentType='telephoneNumber'\n                        placeholder=\"คำตอบ\"\n                        placeholderTextColor=\"gray\"\n                        multiline\n                        numberOfLines={6}\n                        color='blue'\n                        fontSize={16}\n                        onChangeText={text => {\n                            answer[index] = text;\n                        }}\n                        defaultValue={item.answer}\n                    />\n\n                    <Button\n                        style={{\n                            backgroundColor: 'green',\n                            borderRadius: 10,\n                            marginVertical: 8\n                        }}\n                        mode=\"Contained\"\n                        onPress={() => {\n\n                            const dataSend = {\n                                manager_id: managerID,\n                                reveal: checked,\n                                answer: answer[index],\n                                date: moment().format('yyyy-MM-DD'),\n                                department: USER.department\n                            }\n                            console.log(dataSend)\n                            console.log(\"year\", year)\n                            console.log(\"part\", part)\n                            console.log(\"number\", item.number)\n                            console.log(\"userid\", USER.userid)\n                            postAnswer({ dataSend, number: item.number });\n                        }}\n                    >\n                        <Text style={{ alignSelf: 'center', color: 'white' }}>ส่งคำตอบ</Text>\n                    </Button>\n                </View>\n            )\n        }\n\n        return (\n            <FlatList\n                data={questionWithAnswer}\n                extraData={questionWithAnswer}\n                keyExtractor={(item, index) => `${index}`}\n                renderItem={renderItem}\n                ListHeaderComponent={\n                    <View style={{ margin: 16, backgroundColor: 'white', paddingBottom: 16 }}>\n                        <Text style={{ fontSize: 16, margin: 16 }}>* ก่อนตอบคำถาม ท่านต้องการเปิดเผยชื่อให้ผู้จัดการทราบหรือไม่</Text>\n                        <CheckBox\n                            title='ไม่เปิดเผยชื่อ'\n                            checked={checked}\n                            onPress={() => {\n                                setChecked(!checked)\n                                // console.log(checked);\n                            }}\n                        />\n                    </View>\n                }\n            />\n        )\n    }\n\n    return (\n        <View style={{ flex: 1, backgroundColor: 'white' }}>\n\n            {USER.position === 'ผู้จัดการ' ?\n                renderManagerCheck(navigation)\n                :\n                renderUserComment(navigation)\n            }\n        </View>\n    );\n};\n\nconst styles = StyleSheet.create({\n    checkboxContainer: {\n        backgroundColor: 'white',\n        borderColor: 'gray',\n        borderWidth: 3,\n        flexDirection: \"row\",\n        marginBottom: 20,\n    },\n    checkbox: {\n\n        width: 20,\n        height: 20,\n        alignSelf: \"center\",\n    },\n    label: {\n        margin: 8,\n    },\n})\n\nexport default StaffCommentScreen;"]},"metadata":{},"sourceType":"module"}