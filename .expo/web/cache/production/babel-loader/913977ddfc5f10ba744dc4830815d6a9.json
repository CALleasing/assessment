{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _defineProperty from\"@babel/runtime/helpers/defineProperty\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly){symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});}keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import React,{useState,useEffect,useMemo}from'react';import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import Text from\"react-native-web/dist/exports/Text\";import View from\"react-native-web/dist/exports/View\";import ActivityIndicator from\"react-native-web/dist/exports/ActivityIndicator\";import{NavigationContainer}from'@react-navigation/native';import{createStackNavigator}from'@react-navigation/stack';import{createMaterialTopTabNavigator}from'@react-navigation/material-top-tabs';import Icon from\"@expo/vector-icons/FontAwesome\";import{LOGIN}from\"./src/constants/variables\";import HomeScreen from\"./src/screens/HomeScreen\";import AssessmentScreen from\"./src/screens/AssessmentScreen\";import QuestionnaireAllStaffScreen from\"./src/screens/QuestionnaireAllStaffScreen\";import QuestionnaireManagerScreen from\"./src/screens/QuestionnaireManagerScreen\";import VideoWebViewScreen from\"./src/screens/VideoWebViewScreen\";import LoginScreen from\"./src/screens/LoginScreen\";import{AuthContext}from\"./src/components/context\";import RootStackScreen from\"./src/screens/RootStackScreen\";import{COLORS}from\"./src/constants/theme\";var Stack=createStackNavigator();var Tab=createMaterialTopTabNavigator();var Questionnaire=function Questionnaire(_ref){var route=_ref.route;var userId=route.params.userId;var year=route.params.year;var part=route.params.part;return React.createElement(Tab.Navigator,null,React.createElement(Tab.Screen,{name:\"QuestionnaireAllStaff\",component:QuestionnaireAllStaffScreen,options:{title:'ทั่วไป'},initialParams:{userId:userId,year:year,part:part}}),React.createElement(Tab.Screen,{name:\"QuestionnaireManager\",component:QuestionnaireManagerScreen,options:{title:'ผู้จัดการถาม'},initialParams:{userId:userId,year:year,part:part}}));};var App=function App(){var initialLoginState={isLoading:true,userName:null,userToken:null};var loginReducer=function loginReducer(prevState,action){switch(action.type){case'RETRIEVE_TOKEN':return _objectSpread(_objectSpread({},prevState),{},{userToken:action.token,isLoading:false});case'LOGIN':return _objectSpread(_objectSpread({},prevState),{},{userName:action.id,userToken:action.token,isLoading:false});case'LOGOUT':return _objectSpread(_objectSpread({},prevState),{},{userName:null,userToken:null,isLoading:false});}};var _React$useReducer=React.useReducer(loginReducer,initialLoginState),_React$useReducer2=_slicedToArray(_React$useReducer,2),loginState=_React$useReducer2[0],dispacth=_React$useReducer2[1];var authContext=useMemo(function(){return{signIn:function signIn(userName,password){var userToken;userToken=userName;LOGIN.userid=userName;dispacth({type:'LOGIN',id:userName,token:userToken});},signOut:function signOut(){dispacth({type:'LOGOUT'});}};},[]);return React.createElement(AuthContext.Provider,{value:authContext},React.createElement(NavigationContainer,null,loginState.userToken!=null?React.createElement(Stack.Navigator,{screenOptions:{headerShown:true,headerRight:function headerRight(){return React.createElement(Icon,{name:\"sign-out\",size:20,style:{marginHorizontal:16},onPress:function onPress(){authContext.signOut();}});}},initialRouteName:\"Home\"},React.createElement(Stack.Screen,{name:\"Home\",component:HomeScreen,options:{title:'หน้าแรก'},initialParams:{userid:loginState.userToken}}),React.createElement(Stack.Screen,{name:\"Assessment\",component:AssessmentScreen,options:{title:'ปีประเมิน'}}),React.createElement(Stack.Screen,{name:\"Questionnaire\",component:Questionnaire,options:{title:'แบบประเมิน'}}),React.createElement(Stack.Screen,{name:\"VideoWebView\",component:VideoWebViewScreen,options:{title:'ดูวิดีโอ'}})):React.createElement(RootStackScreen,null)));};export default App;","map":{"version":3,"sources":["/Users/drift/Documents/ReactNative/cal-assessment/App.js"],"names":["React","useState","useEffect","useMemo","NavigationContainer","createStackNavigator","createMaterialTopTabNavigator","Icon","LOGIN","HomeScreen","AssessmentScreen","QuestionnaireAllStaffScreen","QuestionnaireManagerScreen","VideoWebViewScreen","LoginScreen","AuthContext","RootStackScreen","COLORS","Stack","Tab","Questionnaire","route","userId","params","year","part","title","App","initialLoginState","isLoading","userName","userToken","loginReducer","prevState","action","type","token","id","useReducer","loginState","dispacth","authContext","signIn","password","userid","signOut","headerShown","headerRight","marginHorizontal"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useMemo } from 'react';\nimport { StyleSheet, Text, View, ActivityIndicator } from 'react-native';\nimport { NavigationContainer } from '@react-navigation/native';\nimport { createStackNavigator } from '@react-navigation/stack';\nimport { createMaterialTopTabNavigator } from '@react-navigation/material-top-tabs';\n\nimport Icon from 'react-native-vector-icons/FontAwesome';\nimport { LOGIN } from './src/constants/variables'\n\nimport HomeScreen from './src/screens/HomeScreen'\nimport AssessmentScreen from './src/screens/AssessmentScreen';\nimport QuestionnaireAllStaffScreen from './src/screens/QuestionnaireAllStaffScreen';\nimport QuestionnaireManagerScreen from './src/screens/QuestionnaireManagerScreen';\nimport VideoWebViewScreen from './src/screens/VideoWebViewScreen';\nimport LoginScreen from './src/screens/LoginScreen';\n\nimport { AuthContext } from './src/components/context';\nimport RootStackScreen from './src/screens/RootStackScreen';\nimport { COLORS } from './src/constants/theme';\n\nconst Stack = createStackNavigator();\nconst Tab = createMaterialTopTabNavigator();\n\nconst Questionnaire = ({ route }) => {\n  let userId = route.params.userId;\n  let year = route.params.year;\n  let part = route.params.part\n\n  // console.log(route);\n  return (\n    <Tab.Navigator>\n      <Tab.Screen\n        name=\"QuestionnaireAllStaff\"\n        component={QuestionnaireAllStaffScreen}\n        options={{ title: 'ทั่วไป' }}\n        initialParams={{ userId: userId, year: year, part: part }} />\n      <Tab.Screen\n        name=\"QuestionnaireManager\"\n        component={QuestionnaireManagerScreen}\n        options={{ title: 'ผู้จัดการถาม' }}\n        initialParams={{ userId: userId, year: year, part: part }} />\n    </Tab.Navigator>\n  );\n}\n\nconst App = () => {\n\n  // const [isLoading, setIsLoading] = useState(true);\n  // const [userToken, setUserToken] = useState(null);\n\n  const initialLoginState = {\n    isLoading: true,\n    userName: null,\n    userToken: null,\n  };\n\n  const loginReducer = (prevState, action) => {\n    switch (action.type) {\n      case 'RETRIEVE_TOKEN':\n        return {\n          ...prevState,\n          userToken: action.token,\n          isLoading: false\n        };\n      case 'LOGIN':\n        return {\n          ...prevState,\n          userName: action.id,\n          userToken: action.token,\n          isLoading: false\n        };\n      case 'LOGOUT':\n        return {\n          ...prevState,\n          userName: null,\n          userToken: null,\n          isLoading: false\n        };\n    }\n  };\n\n  const [loginState, dispacth] = React.useReducer(loginReducer, initialLoginState);\n\n  const authContext = useMemo(() => ({\n    signIn: (userName, password) => {\n      // setUserToken('asdf');\n      // setIsLoading(false);\n      let userToken;\n      // userName = null;\n      // if (userName === 'User' && password === 'Pass') {\n      userToken = userName;\n      LOGIN.userid = userName;\n\n      // console.log(LOGIN.userid);\n      // }\n      dispacth({ type: 'LOGIN', id: userName, token: userToken });\n    },\n    signOut: () => {\n      // setUserToken(null);\n      // setIsLoading(false);\n      dispacth({ type: 'LOGOUT' });\n    },\n  }), []);\n\n  // useEffect(() => {\n  //   setTimeout(() => {\n  //     // setIsLoading(false);\n  //     // dispacth({ type: 'RETRIEVE_TOKEN', token: '' });\n  //   }, 1000);\n\n  // }, [])\n\n  // if (loginState.isLoading) {\n  //   return (\n  //     <View style={{ flex: 1, justifyContent: 'center', alignItems: 'center' }}>\n  //       <ActivityIndicator size=\"large\" />\n  //     </View>\n  //   )\n  // }\n\n  return (\n    <AuthContext.Provider value={authContext}>\n      <NavigationContainer>\n      {/* {console.log(loginState.userToken)} */}\n        {loginState.userToken != null ? (\n         \n          <Stack.Navigator\n            screenOptions={{\n              headerShown: true,\n              headerRight: () => <Icon name='sign-out'\n                // color= {COLORS.primary}\n                size={20}\n                style={{ marginHorizontal: 16 }}\n                onPress={() => {\n                  authContext.signOut()\n                }}\n              />\n            }}\n            initialRouteName=\"Home\">\n\n            <Stack.Screen name=\"Home\" component={HomeScreen} options={{ title: 'หน้าแรก', }} initialParams={{ userid: loginState.userToken }} />\n            <Stack.Screen name=\"Assessment\" component={AssessmentScreen} options={{ title: 'ปีประเมิน' }} />\n            <Stack.Screen name=\"Questionnaire\" component={Questionnaire} options={{ title: 'แบบประเมิน' }} />\n            <Stack.Screen name=\"VideoWebView\" component={VideoWebViewScreen} options={{ title: 'ดูวิดีโอ' }} />\n          </Stack.Navigator>\n        )\n\n          :\n\n          <RootStackScreen />\n        }\n\n      </NavigationContainer>\n\n    </AuthContext.Provider>\n\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}