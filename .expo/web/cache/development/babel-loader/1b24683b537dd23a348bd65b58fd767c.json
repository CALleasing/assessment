{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/drift/Documents/ReactNative/cal-assessment/src/screens/LoginScreen.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState, useEffect } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport { Button, Avatar } from 'react-native-paper';\nimport * as Animatable from 'react-native-animatable';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { AuthContext } from \"../components/context\";\nimport axiox from 'axios';\nimport Icon from \"@expo/vector-icons/FontAwesome\";\nimport { COLORS } from \"../constants/theme\";\nimport { USER } from \"../constants/variables\";\n\nvar LoginScreen = function LoginScreen(_ref) {\n  var navigation = _ref.navigation;\n\n  var _useState = useState(\"\"),\n      _useState2 = _slicedToArray(_useState, 2),\n      textError = _useState2[0],\n      setTextError = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      isLoading = _useState4[0],\n      setIsLoading = _useState4[1];\n\n  var _useState5 = useState({\n    username: '',\n    password: '',\n    check_textInputChange: false,\n    secureTextEntry: true\n  }),\n      _useState6 = _slicedToArray(_useState5, 2),\n      data = _useState6[0],\n      setData = _useState6[1];\n\n  var login = function login() {\n    var object = {\n      userid: data.username,\n      password: data.password\n    };\n    axiox.post('https://program-api.herokuapp.com/login', object).then(function (res) {\n      console.log(res.data);\n      setIsLoading(false);\n      USER.name = res.data.name;\n      USER.lastname = res.data.lastname;\n      USER.nickname = res.data.nickname;\n      USER.phone = res.data.phone;\n      loginHandle(res.data.userid, res.data.position, res.data.department);\n      loginSaveState(res.data);\n    }).catch(function (err) {\n      setTextError(\"User ID หรือ Password ไม่ถูกต้อง\");\n      console.log(err);\n      setIsLoading(false);\n    });\n  };\n\n  var loginSaveState = function loginSaveState(userData) {\n    var jsonAllValue;\n    return _regeneratorRuntime.async(function loginSaveState$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            jsonAllValue = JSON.stringify(userData);\n            console.log(jsonAllValue);\n            _context.next = 5;\n            return _regeneratorRuntime.awrap(AsyncStorage.setItem('user_login', jsonAllValue));\n\n          case 5:\n            _context.next = 10;\n            break;\n\n          case 7:\n            _context.prev = 7;\n            _context.t0 = _context[\"catch\"](0);\n            console.log(_context.t0);\n\n          case 10:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[0, 7]], Promise);\n  };\n\n  var checkLoginState = function checkLoginState() {\n    var jsonValue, userInfo;\n    return _regeneratorRuntime.async(function checkLoginState$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            _context2.next = 3;\n            return _regeneratorRuntime.awrap(AsyncStorage.getItem('user_login'));\n\n          case 3:\n            jsonValue = _context2.sent;\n\n            if (jsonValue !== null) {\n              userInfo = JSON.parse(jsonValue);\n              console.log(userInfo);\n              USER.userid = userInfo.userid;\n              USER.position = userInfo.position;\n              USER.department = userInfo.department;\n              loginHandle(userInfo.userid, userInfo.position, userInfo.department);\n            } else {}\n\n            _context2.next = 10;\n            break;\n\n          case 7:\n            _context2.prev = 7;\n            _context2.t0 = _context2[\"catch\"](0);\n            console.log(_context2.t0);\n\n          case 10:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, [[0, 7]], Promise);\n  };\n\n  useEffect(function () {\n    checkLoginState();\n  }, []);\n\n  var _React$useContext = React.useContext(AuthContext),\n      signIn = _React$useContext.signIn;\n\n  var textInputChange = function textInputChange(val) {\n    if (val.length != 0) {\n      setData(_objectSpread(_objectSpread({}, data), {}, {\n        username: val,\n        check_textInputChange: true\n      }));\n    } else {\n      setData(_objectSpread(_objectSpread({}, data), {}, {\n        username: val,\n        check_textInputChange: false\n      }));\n    }\n  };\n\n  var handlePasswordChange = function handlePasswordChange(val) {\n    setData(_objectSpread(_objectSpread({}, data), {}, {\n      password: val\n    }));\n  };\n\n  var updateSecureTextEntry = function updateSecureTextEntry(val) {\n    setData(_objectSpread(_objectSpread({}, data), {}, {\n      secureTextEntry: !data.secureTextEntry\n    }));\n  };\n\n  var loginHandle = function loginHandle(username, position, department) {\n    signIn(username, position, department);\n  };\n\n  return React.createElement(View, {\n    style: styles.container,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 9\n    }\n  }, React.createElement(View, {\n    style: styles.header,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 13\n    }\n  }, React.createElement(Text, {\n    style: styles.text_header,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 17\n    }\n  }, \"\\u0E41\\u0E1A\\u0E1A\\u0E1B\\u0E23\\u0E30\\u0E40\\u0E21\\u0E34\\u0E19\\u0E1E\\u0E19\\u0E31\\u0E01\\u0E07\\u0E32\\u0E19\")), React.createElement(Animatable.View, {\n    style: styles.footer,\n    animation: \"fadeInUpBig\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 13\n    }\n  }, React.createElement(Text, {\n    style: styles.text_footer,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 17\n    }\n  }, \"User ID\"), React.createElement(View, {\n    style: styles.action,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 17\n    }\n  }, React.createElement(Icon, {\n    name: \"user\",\n    color: COLORS.primary,\n    size: 20,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 21\n    }\n  }), React.createElement(TextInput, {\n    placeholder: \"User ID ...\",\n    style: styles.text_input,\n    onChangeText: function onChangeText(val) {\n      return textInputChange(val);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 21\n    }\n  })), React.createElement(Text, {\n    style: styles.text_footer,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 17\n    }\n  }, \"Password\"), React.createElement(View, {\n    style: styles.action,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 17\n    }\n  }, React.createElement(Icon, {\n    name: \"lock\",\n    color: COLORS.primary,\n    size: 20,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 21\n    }\n  }), React.createElement(TextInput, {\n    placeholder: \"Password ...\",\n    style: styles.text_input,\n    onChangeText: function onChangeText(val) {\n      return handlePasswordChange(val);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 21\n    }\n  })), React.createElement(Text, {\n    style: {\n      alignSelf: 'center',\n      color: 'red',\n      marginTop: 26\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 17\n    }\n  }, textError), React.createElement(Button, {\n    style: {\n      borderRadius: 10,\n      marginTop: 16,\n      backgroundColor: COLORS.primary\n    },\n    mode: \"contained\",\n    onPress: function onPress() {\n      setIsLoading(true);\n      login();\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 17\n    }\n  }, React.createElement(Text, {\n    style: {\n      fontSize: 18\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 21\n    }\n  }, \"\\u0E40\\u0E02\\u0E49\\u0E32\\u0E2A\\u0E39\\u0E48\\u0E23\\u0E30\\u0E1A\\u0E1A\")), isLoading ? React.createElement(ActivityIndicator, {\n    style: {\n      marginTop: 20,\n      alignItems: 'center',\n      justifyContent: 'center'\n    },\n    size: \"large\",\n    color: \"#0275d8\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 21\n    }\n  }) : null));\n};\n\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: COLORS.primary\n  },\n  footer: {\n    flex: 4,\n    backgroundColor: 'white',\n    borderTopLeftRadius: 30,\n    borderTopRightRadius: 30,\n    paddingHorizontal: 20,\n    paddingVertical: 30\n  },\n  header: {\n    flex: 1,\n    justifyContent: 'flex-end',\n    paddingHorizontal: 20,\n    paddingBottom: 50\n  },\n  logo: {\n    alignItems: 'center',\n    justifyContent: 'center'\n  },\n  text_header: {\n    alignSelf: 'center',\n    justifyContent: 'center',\n    color: 'white',\n    fontWeight: 'bold',\n    fontSize: 24\n  },\n  action: {\n    flexDirection: 'row',\n    margin: 10,\n    borderBottomWidth: 1,\n    borderBottomColor: '#f2f2f2',\n    paddingBottom: 5\n  },\n  text_input: {\n    flex: 1,\n    paddingLeft: 10,\n    color: '#008080'\n  },\n  text_footer: {\n    color: COLORS.primary,\n    fontSize: 18\n  }\n});\nexport default LoginScreen;","map":{"version":3,"sources":["/Users/drift/Documents/ReactNative/cal-assessment/src/screens/LoginScreen.js"],"names":["React","useState","useEffect","Button","Avatar","Animatable","AsyncStorage","AuthContext","axiox","Icon","COLORS","USER","LoginScreen","navigation","textError","setTextError","isLoading","setIsLoading","username","password","check_textInputChange","secureTextEntry","data","setData","login","object","userid","post","then","res","console","log","name","lastname","nickname","phone","loginHandle","position","department","loginSaveState","catch","err","userData","jsonAllValue","JSON","stringify","setItem","checkLoginState","getItem","jsonValue","userInfo","parse","useContext","signIn","textInputChange","val","length","handlePasswordChange","updateSecureTextEntry","styles","container","header","text_header","footer","text_footer","action","primary","text_input","alignSelf","color","marginTop","borderRadius","backgroundColor","fontSize","alignItems","justifyContent","StyleSheet","create","flex","borderTopLeftRadius","borderTopRightRadius","paddingHorizontal","paddingVertical","paddingBottom","logo","fontWeight","flexDirection","margin","borderBottomWidth","borderBottomColor","paddingLeft"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { View, Text, TextInput, SafeAreaView, ScrollView, ActivityIndicator, StyleSheet } from 'react-native';\nimport { Button, Avatar } from 'react-native-paper';\nimport * as Animatable from 'react-native-animatable';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { AuthContext } from '../components/context';\nimport axiox from 'axios';\n\nimport Icon from 'react-native-vector-icons/FontAwesome';\nimport { COLORS } from '../constants/theme';\nimport { USER } from '../constants/variables';\n\nconst LoginScreen = ({ navigation }) => {\n\n    const [textError, setTextError] = useState(\"\");\n    const [isLoading, setIsLoading] = useState(false);\n    // const userInfo;\n\n    const [data, setData] = useState({\n        username: '',\n        password: '',\n        check_textInputChange: false,\n        secureTextEntry: true\n    });\n\n    const login = () => {\n        const object = {\n            userid: data.username,\n            password: data.password\n        }\n\n        axiox.post('https://program-api.herokuapp.com/login', object)\n            .then(res => {\n                console.log(res.data);\n                setIsLoading(false);\n                // setUserInfo(res.data);\n                USER.name = res.data.name;\n                USER.lastname = res.data.lastname;\n                USER.nickname = res.data.nickname;\n                USER.phone = res.data.phone;\n                loginHandle(res.data.userid, res.data.position, res.data.department);\n                // console.log(res.data.position);\n                \n                loginSaveState(res.data);\n            })\n            .catch(err => {\n                // showDialog();\n                // setTextQueue(\"การจองล้มเหลว \\nเนื่องจากคิวเต็ม\");\n                // setStatus(\"จองคิวล้มเหลว\");\n                setTextError(\"User ID หรือ Password ไม่ถูกต้อง\")\n                console.log(err)\n                setIsLoading(false);\n            });\n\n    }\n\n    const loginSaveState = async (userData) => {\n        try {\n            // const jsonValue = await AsyncStorage.getItem('book_service');\n            // var allData = [];\n            // if (jsonValue !== null) {\n\n            //     allData = JSON.parse(jsonValue);\n            //     allData.push(newValue);\n            // }\n            // else {\n            //     allData.push(newValue);\n            // }\n\n            const jsonAllValue = JSON.stringify(userData);\n            console.log(jsonAllValue);\n            await AsyncStorage.setItem('user_login', jsonAllValue);\n\n            // setSuccess(true);\n\n            // console.log(data);\n        } catch (e) {\n            console.log(e);\n        }\n    }\n\n    const checkLoginState = async () => {\n        try {\n            const jsonValue = await AsyncStorage.getItem('user_login');\n            // var allData = [];\n            if (jsonValue !== null) {\n               \n                const userInfo = JSON.parse(jsonValue); \n\n                console.log(userInfo);\n\n                USER.userid = userInfo.userid;\n                USER.position = userInfo.position;\n                USER.department = userInfo.department;\n                loginHandle(userInfo.userid, userInfo.position, userInfo.department)\n                // allData.push(newValue);\n            }\n            else {\n                // allData.push(newValue);\n            }\n        }\n        catch (e) {\n            console.log(e);\n        }\n    }\n\n    useEffect(() => {\n        // setTimeout(() => {\n            checkLoginState();\n        //  }, 2000);\n    \n    }, []);\n\n    const { signIn } = React.useContext(AuthContext);\n\n    const textInputChange = (val) => {\n        if (val.length != 0) {\n            setData({\n                ...data,\n                username: val,\n                check_textInputChange: true\n            });\n        } else {\n            setData({\n                ...data,\n                username: val,\n                check_textInputChange: false\n            });\n        }\n    }\n\n    const handlePasswordChange = (val) => {\n        setData({\n            ...data,\n            password: val,\n        });\n    }\n\n    const updateSecureTextEntry = (val) => {\n        setData({\n            ...data,\n            secureTextEntry: !data.secureTextEntry\n        });\n    }\n\n    const loginHandle = (username, position, department) => {\n        signIn(username, position, department);\n        // console.log(username, password);\n    }\n\n    return (\n        <View style={styles.container}>\n\n            <View style={styles.header}>\n\n                <Text style={styles.text_header}>แบบประเมินพนักงาน</Text>\n            </View>\n            {/* <Text> CAL</Text> */}\n            <Animatable.View style={styles.footer}\n                animation='fadeInUpBig'>\n                <Text style={styles.text_footer}>User ID</Text>\n                <View style={styles.action}>\n                    <Icon name='user'\n                        color={COLORS.primary}\n                        size={20} />\n                    <TextInput placeholder=\"User ID ...\"\n                        style={styles.text_input}\n                        onChangeText={(val) => textInputChange(val)} />\n                </View>\n\n                <Text style={styles.text_footer}>Password</Text>\n                <View style={styles.action}>\n                    <Icon name='lock'\n                        color={COLORS.primary}\n                        size={20} />\n                    <TextInput placeholder=\"Password ...\"\n                        style={styles.text_input}\n                        onChangeText={(val) => handlePasswordChange(val)} />\n                </View>\n\n                <Text style={{ alignSelf: 'center', color: 'red', marginTop: 26 }}>{textError}</Text>\n\n                <Button\n                    style={{ borderRadius: 10, marginTop: 16, backgroundColor: COLORS.primary }}\n                    // icon=\"camera\"\n                    mode=\"contained\"\n                    onPress={() => {\n                        setIsLoading(true);\n                        login();\n                    }}>\n                    <Text style={{ fontSize: 18 }}>เข้าสู่ระบบ</Text>\n                </Button>\n\n                {isLoading ?\n\n                    <ActivityIndicator style={{\n                        marginTop: 20,\n                        // position: 'absolute',\n                        // left: 0,\n                        // right: 0,\n                        // top: 0,\n                        // bottom: 0,\n                        alignItems: 'center',\n                        justifyContent: 'center'\n                    }} size=\"large\" color=\"#0275d8\" />\n\n                    :\n\n                    null\n                }\n\n\n            </Animatable.View>\n\n        </View>\n\n    );\n}\n\nconst styles = StyleSheet.create({\n    container: {\n        // justifyContent: 'center',\n        flex: 1,\n        backgroundColor: COLORS.primary\n    },\n    footer: {\n        flex: 4,\n        // justifyContent: 'center',\n        backgroundColor: 'white',\n        borderTopLeftRadius: 30,\n        borderTopRightRadius: 30,\n        paddingHorizontal: 20,\n        paddingVertical: 30\n    },\n    header: {\n        flex: 1,\n        justifyContent: 'flex-end',\n        paddingHorizontal: 20,\n        paddingBottom: 50,\n    },\n    logo: {\n        alignItems: 'center',\n        justifyContent: 'center',\n        // marginTop: 50\n    },\n    text_header: {\n        alignSelf: 'center',\n        justifyContent: 'center',\n        color: 'white',\n        fontWeight: 'bold',\n        fontSize: 24\n    },\n    action: {\n        flexDirection: 'row',\n        margin: 10,\n        borderBottomWidth: 1,\n        borderBottomColor: '#f2f2f2',\n        paddingBottom: 5\n    },\n    text_input: {\n        flex: 1,\n        paddingLeft: 10,\n        color: '#008080'\n    },\n    text_footer: {\n        color: COLORS.primary,\n        fontSize: 18,\n    },\n})\n\nexport default LoginScreen;"]},"metadata":{},"sourceType":"module"}